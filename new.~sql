select * from Mr_Send


select * from MR_RECEIVE_IMPORT_ACCOUNT
-- 
select * from students
drop table students
create table students(
names varchar2(10),
phone varchar2(12),
age varchar2(5)
)
insert into students values('dfdf','20');
 


select 1 from MR_RECEIVE_PRODUCT

select * from MR_RECEIVE_PRODUCT
--20170322140438856844

create  table Mr_Send(

InvestAppSheetNo varchar2(30),
InvestManagerCode varchar2(30),
CustodialCode varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
InvestorName varchar2(30),
CertificateType varchar2(30),
CertificateNo varchar2(30),
BankAccountNum varchar2(30),
AccountName varchar2(30),
AccountAgency varchar2(30),
AccountNo varchar2(30),
AccountAgencyRegion varchar2(30),
LargePayNum   varchar2(30),
EndOfArray  varchar2(30),
InvestProductType varchar2(30),
IndividualOrInstitution varchar2(30),
InstReprIDCode varchar2(30),
InstReprIDType varchar2(30),
InstReprName varchar2(30),
SendAttachFlag  varchar2(30),
InstReprCertValidDate varchar2(8)

)

27 31









create sequence test_id

 alter table [表名] add 字段名 smallint default 0 增加数字字段，整型，缺省值为0 
alter table Mr_Receive drop column MsgType  
alter table Mr_Receive add MsgType VARCHAR2(10) 
drop table Mr_Receive
SELECT * FROM Mr_Receive


create table Mr_Receive(
    MsgType VARCHAR2(30),
    OriginalMsgID VARCHAR2(30),
     InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
     CustodialCode VARCHAR2(30),
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
     InvestorName VARCHAR2(30),
     CertificateType VARCHAR2(30),
     CertificateNo VARCHAR2(30),
 --    CertValidDate VARCHAR2(30),
    BankAccountNum VARCHAR2(30),
    AccountName VARCHAR2(30),
    AccountAgency VARCHAR2(30),
    AccountNo VARCHAR2(30),
    AccountAgencyRegion VARCHAR2(30),
    LargePayNum VARCHAR2(30),
    EndOfArray VARCHAR2(30),
    InvestProductType VARCHAR2(30),
    IndividualOrInstitution VARCHAR2(30),
   -- private String AccountAbbr;
   InstReprIDCode VARCHAR2(30),
    InstReprIDType VARCHAR2(30),
   InstReprName VARCHAR2(30),
 --  private String DistributorCod
    DealStatus  VARCHAR2(30),
    ReturnCode VARCHAR2(30),
    MakeFailRole varchar2(5),
    ErrorDetail  varchar2(45)
    
)
-- 存量账户

select * from Mr_Send

create table Mr_Send_Stock_Account(
MsgType varchar2(5),
BusinessCode varchar2(5),
InvestAppSheetNo varchar2(30),
InvestProductCode varchar2(30),
InvestManagerCode varchar2(30),
RegistrarCode2 varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
SendAttachFlag  varchar2(2),
SendAccAttach  varchar2(2),
DistributorCode2 varchar2(20),
TAAccountID varchar2(20),
OriginalAcctName varchar2(20),
OriginalCertificateType varchar(10),
OriginalCertificateNo varchar2(20)
)

select * from MR_RECEIVE_STOCK_ACCOUNT

create table MR_RECEIVE_STOCK_ACCOUNT(
     MsgType VARCHAR2(5),
     BusinessCode  VARCHAR2(5),
     StepCode VARCHAR2(10),
     OriginalMsgID VARCHAR2(30),
     InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
     CustodialCode VARCHAR2(30),
     CustodylFlag varchar2(2),
     RegistrarCode2 varchar2(20),
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
     InvestorName VARCHAR2(30),
     CertificateType VARCHAR2(30),
     CertificateNo VARCHAR2(30),
     InvestProductType VARCHAR2(30),
     IndividualOrInstitution VARCHAR2(30),
     InstReprIDCode VARCHAR2(30),
     InstReprIDType VARCHAR2(30),
     InstReprName VARCHAR2(30),
     DistributorCode2  varchar2(35),
     OriginalAcctName VARCHAR2(30),
     OriginalCertificateType VARCHAR2(20),
     OriginalCertificateNo VARCHAR2(30),
     DealStatus  VARCHAR2(30),
     ReturnCode VARCHAR2(30),
     MakeFailRole varchar2(5),
     ErrorDetail  varchar2(45)
)


-- 时间
-- 创建账户表字段  ok
drop table Mr_Send_Account
select * from Mr_Send_Account
select t.*, t.rowid from Mr_Send_Account t
investappsheetno =  '201704251641359893319090';

alter table Mr_Send_Account add MsgType VARCHAR2(10);
alter table Mr_Send_Account add BusinessCode VARCHAR2(10);


create table Mr_Send_Account(

InvestAppSheetNo varchar2(30),
InvestProductCode varchar2(30),
InvestManagerCode varchar2(30),
RegistrarCode2 varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
SendAttachFlag  varchar2(2),
SendAccAttach  varchar2(2),
DistributorCode2 varchar2(20)
)
--创建账户接收的数据  pk
drop table Mr_Receive_Account

select * from  Mr_Receive_Account

create table Mr_Receive_Account(
     MsgType VARCHAR2(10),
     OriginalMsgID VARCHAR2(30),
     InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
     CustodialCode VARCHAR2(30),
     CustodylFlag varchar2(2),
     RegistrarCode2 varchar2(20),
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
     InvestorName VARCHAR2(30),
     CertificateType VARCHAR2(30),
     CertificateNo VARCHAR2(30),
     InvestProductType VARCHAR2(30),
     IndividualOrInstitution VARCHAR2(30),
     InstReprIDCode VARCHAR2(30),
     InstReprIDType VARCHAR2(30),
     InstReprName VARCHAR2(30),
     DistributorCode2  varchar2(50),
     DealStatus  VARCHAR2(30),
     ReturnCode VARCHAR2(30),
     MakeFailRole varchar2(5),
     ErrorDetail  varchar2(45)
    )


--申购 
drop table Mr_Send_Bid  -- ok

create table Mr_Send_Bid(
InvestAppSheetNo varchar2(30),
InvestProductCode varchar2(30),
InvestManagerCode varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
SendAttachFlag  varchar2(2),
FundCode  varchar2(10),
ApplicationAmount varchar2(15),

AccountName2 varchar2(15), 
AccountAgency2 varchar2(30),
AccountNo2 varchar2(20),
AccountAgencyRegion2 varchar2(15),
LargePayNum2 varchar2(20),
DistributorCode2  varchar2(50),
TransactionAccountID  varchar2(30)
--
)




--申购   ok 
drop table Mr_Receive_Bid
select * from Mr_Receive_Bid

create table Mr_Receive_Bid(
MsgType VARCHAR2(10),
    OriginalMsgID VARCHAR2(30),
 InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
     CustodylFlag varchar2(2),
     
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
     IndividualOrInstitution varchar2(5),
     FundCode  varchar2(10),
     ApplicationAmount varchar2(15),
  
   AccountName VARCHAR2(30),
   AccountAgency VARCHAR2(30),
    AccountNo VARCHAR2(30),
    AccountAgencyRegion VARCHAR2(30),
    LargePayNum VARCHAR2(30),
    AccountName2 VARCHAR2(30),
   AccountAgency2 VARCHAR2(30),
  AccountNo2 VARCHAR2(30),
  AccountAgencyRegion2 VARCHAR2(30),
  LargePayNum2 VARCHAR2(30),
   
   DistributorCode2 VARCHAR2(50),
   TransactionAccountID VARCHAR2(30),
    DealStatus  VARCHAR2(30),
    ReturnCode VARCHAR2(30),
    MakeFailRole varchar2(5),
    ErrorDetail  varchar2(45)
    )
drop PROCEDURE SP_GETDAY
CREATE OR REPLACE PROCEDURE SP_GETDAY
( dtDay OUT CHAR)
IS
BEGIN
 SELECT to_char(to_date('20170413','yyyyMMdd'),'day') INTO dtDay FROM dual;
 commit;
END SP_GETDAY;

declare 
i CHAR;
begin 
 SP_GETDAY(i);
 DBMS_OUTPUT.put_line(i);
end;

begin
    SP_GETDAY('20170413');
end;

execute 
TransactionAccountID
--赎回   ok 
drop table Mr_Send_redeem
select * from Mr_Send_redeem
create table Mr_Send_Redeem(
InvestAppSheetNo varchar2(30),
InvestProductCode varchar2(30),
InvestManagerCode varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
SendAttachFlag  varchar2(2),
FundCode  varchar2(10),
ApplicationVol varchar2(15),
LargeRedemptionFlag varchar2(15), 
DistributorCode2  varchar2(50),
TransactionAccountID  varchar2(30)

)



select  T.*,T.ROWID FROM Mr_Receive_Redeem T 
drop table  Mr_Receive_Redeem
select * from Mr_Receive_Redeem

select NVL(registrarcode2,0) as wert,MSGTYPE AS MSG from Mr_Receive_Redeem t where investappsheetno='201704181736243386245353';

--赎回
create table Mr_Receive_Redeem(
     MsgType VARCHAR2(10),
     OriginalMsgID VARCHAR2(30),
     InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
     CustodylFlag varchar2(2),
     RegistrarCode2 varchar2(20),
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
     IndividualOrInstitution varchar2(5),
     FundCode  varchar2(10),
     ApplicationVol varchar2(15),
     VARCHAR2(50),
     TransactionAccountID  varchar2(30),
  
    DealStatus  VARCHAR2(30),
    ReturnCode VARCHAR2(30),
    MakeFailRole varchar2(5),
    ErrorDetail  varchar2(45)
    )
    
--中车信息

 select * from Mr_Send_Trade
  
create table Mr_Send_Trade(
InvestAppSheetNo varchar2(30),
InvestProductCode varchar2(30),
InvestManagerCode varchar2(30),
TransactionDate varchar2(30),
TransactionTime varchar2(30),
SendAttachFlag  varchar2(2),
FundCode  varchar2(10),
ApplicationVol varchar2(15),
TargetDistributorCode varchar2(30),
TargetBranchCode varchar2(30),
CodeOfTargetFund varchar2(30),
DefDividendMethod varchar2(5),
OriginalAppDate varchar2(30),
OriginalAppSheetNo varchar2(30),
LargeRedemptionFlag varchar2(15), 
DistributorCode2  varchar2(50),
TransactionAccountID  varchar2(30)

)


--private String targetDistributorCode;
    private String targetTransactionAccountID;
    private String codeOfTargetFund;
    private String defDividendMethod;
    private String originalAppDate;
    private String originalAppSheetNo;
    
drop table Mr_Receive_Trade
select * FROM Mr_Receive_Trade
create table Mr_Receive_Trade(
     MsgType VARCHAR2(10),
     OriginalMsgID VARCHAR2(30),
     BusinessCode VARCHAR2(30),
     StepCode VARCHAR2(30),
     InvestAppSheetNo VARCHAR2(30),
     FispSerialNo VARCHAR2(30),
     InvestProductCode VARCHAR2(30),
     InvestManagerCode VARCHAR2(30),
    
     CustodylFlag varchar2(10),
     RegistrarCode2 varchar2(20),
     TransactionDate VARCHAR2(30),
     TransactionTime VARCHAR2(30),
    IndividualOrInstitution varchar2(5),
    FundCode  varchar2(10),
    ApplicationVol varchar2(15),
    
    TargetDistributorCode VARCHAR2(30),
    TargetTransactionAccountID VARCHAR2(30),
    CodeOfTargetFund VARCHAR2(30),
    DefDividendMethod VARCHAR2(5),
    OriginalAppDate VARCHAR2(10),
    OriginalAppSheetNo VARCHAR2(10),
    
    DistributorCode2 VARCHAR2(50),
    TransactionAccountID  varchar2(30),
  
    DealStatus  VARCHAR2(30),
    ReturnCode VARCHAR2(80),
    MakeFailRole varchar2(5),
    ErrorDetail  varchar2(45)
    )
    

select * from fisp_recv_msg t;
select * from fisp_send_msg t;



SELECT NVL(MAX(T.BATCH_TIME), 0) + 1 AS SEQNO
 FROM DIRECTBANK_FILE_UPLOAD_LOG T
 WHERE T.CHANNEL_CODE = 'dyccb'
       AND T.BATCH_DATE = '20150415'
       AND T.JSP_FILE_NAME = 'ackFdacRecordFile';
       
   select * from DIRECTBANK_FILE_UPLOAD_LOG order by BATCH_DATE DESC;
   
   
  
       
       
       
       
       
 
